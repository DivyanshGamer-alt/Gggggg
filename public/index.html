
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Bot Controller</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .header h1 {
            color: #333;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #666;
            font-size: 1.1rem;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
        }
        
        .btn-start {
            background: #4CAF50;
            color: white;
        }
        
        .btn-stop {
            background: #f44336;
            color: white;
        }
        
        .btn-rejoin {
            background: #FF9800;
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .status-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border-left: 5px solid #667eea;
        }
        
        .status-card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .status-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .status-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .status-label {
            font-weight: 600;
            color: #555;
        }
        
        .status-value {
            color: #333;
            font-family: 'Courier New', monospace;
        }
        
        .online {
            color: #4CAF50;
            font-weight: bold;
        }
        
        .offline {
            color: #f44336;
            font-weight: bold;
        }
        
        .logs {
            background: #1e1e1e;
            color: #00ff00;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        
        .logs-header {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3rem;
            font-weight: bold;
        }
        
        .bot-vision {
            margin-bottom: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border-left: 5px solid #667eea;
        }
        
        .bot-vision h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.3rem;
        }
        
        .vision-container {
            position: relative;
            display: inline-block;
            border: 3px solid #333;
            border-radius: 10px;
            overflow: hidden;
            background: #87CEEB;
        }
        
        #botVisionCanvas {
            display: block;
            background: linear-gradient(to bottom, #87CEEB 0%, #98FB98 70%, #8B4513 100%);
        }
        
        .vision-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }
        
        .crosshair {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
        }
        
        .crosshair::before,
        .crosshair::after {
            content: '';
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
        }
        
        .crosshair::before {
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            transform: translateY(-50%);
        }
        
        .crosshair::after {
            left: 50%;
            top: 0;
            bottom: 0;
            width: 2px;
            transform: translateX(-50%);
        }
        
        .vision-info {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 12px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        .vision-info span {
            display: block;
            margin-bottom: 4px;
        }
        
        .vision-info span:last-child {
            margin-bottom: 0;
        }
        
        .health-bar {
            width: 100%;
            height: 20px;
            background: #ddd;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .health-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff4444 0%, #ffaa00 50%, #44ff44 100%);
            transition: width 0.3s ease;
        }
        
        .hunger-bar {
            width: 100%;
            height: 20px;
            background: #ddd;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .hunger-fill {
            height: 100%;
            background: linear-gradient(90deg, #8B4513 0%, #DAA520 100%);
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ Minecraft Bot Controller</h1>
            <p>Control and monitor your AFK bot</p>
        </div>
        
        <div class="controls">
            <button class="btn btn-start" onclick="startBot()">üöÄ Start Bot</button>
            <button class="btn btn-stop" onclick="stopBot()">‚èπÔ∏è Stop Bot</button>
            <button class="btn btn-rejoin" onclick="rejoinBot()">üîÑ Rejoin</button>
        </div>
        
        <div class="bot-vision">
            <h3>üëÅÔ∏è Bot Live View</h3>
            <div class="vision-container">
                <canvas id="botVisionCanvas" width="800" height="450"></canvas>
                <div class="vision-overlay">
                    <div class="crosshair"></div>
                    <div class="vision-info">
                        <span id="lookDirection">Looking: N/A</span>
                        <span id="nearestEntity">Nearest: None</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="status-grid">
            <div class="status-card">
                <h3>üîó Connection Status</h3>
                <div class="status-item">
                    <span class="status-label">Status:</span>
                    <span class="status-value" id="connectionStatus">Offline</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Server:</span>
                    <span class="status-value" id="serverAddress">-</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Username:</span>
                    <span class="status-value" id="botUsername">-</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Version:</span>
                    <span class="status-value" id="gameVersion">-</span>
                </div>
            </div>
            
            <div class="status-card">
                <h3>üìä Bot Stats</h3>
                <div class="status-item">
                    <span class="status-label">Health:</span>
                    <span class="status-value" id="botHealth">-</span>
                </div>
                <div class="health-bar">
                    <div class="health-fill" id="healthBar" style="width: 0%"></div>
                </div>
                <div class="status-item">
                    <span class="status-label">Hunger:</span>
                    <span class="status-value" id="botHunger">-</span>
                </div>
                <div class="hunger-bar">
                    <div class="hunger-fill" id="hungerBar" style="width: 0%"></div>
                </div>
                <div class="status-item">
                    <span class="status-label">Deaths:</span>
                    <span class="status-value" id="deathCount">0</span>
                </div>
            </div>
            
            <div class="status-card">
                <h3>üìç Position & Activity</h3>
                <div class="status-item">
                    <span class="status-label">X:</span>
                    <span class="status-value" id="posX">-</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Y:</span>
                    <span class="status-value" id="posY">-</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Z:</span>
                    <span class="status-value" id="posZ">-</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Moving:</span>
                    <span class="status-value" id="isMoving">No</span>
                </div>
            </div>
            
            <div class="status-card">
                <h3>üìà Counters</h3>
                <div class="status-item">
                    <span class="status-label">Popularity:</span>
                    <span class="status-value" id="popularityCount">0</span>
                </div>
                <div class="status-item">
                    <span class="status-label">PvP Fights:</span>
                    <span class="status-value" id="pvpCount">0</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Simp Count:</span>
                    <span class="status-value" id="simpCount">0</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Uptime:</span>
                    <span class="status-value" id="uptime">00:00:00</span>
                </div>
            </div>
        </div>
        
        <div>
            <h3 class="logs-header">üìù Console Logs</h3>
            <div class="logs" id="consoleLogs">Bot is ready to start...</div>
        </div>
    </div>

    <script>
        let botStatus = {
            online: false,
            health: 0,
            hunger: 0,
            position: { x: 0, y: 0, z: 0 },
            moving: false,
            deaths: 0,
            popularity: 0,
            pvp: 0,
            simp: 0,
            startTime: null,
            lookDirection: { yaw: 0, pitch: 0 },
            nearestEntity: null,
            blocks: [],
            entities: []
        };

        // Canvas setup for bot vision
        const canvas = document.getElementById('botVisionCanvas');
        const ctx = canvas.getContext('2d');

        function drawBotVision() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw sky gradient
            const skyGradient = ctx.createLinearGradient(0, 0, 0, canvas.height * 0.7);
            skyGradient.addColorStop(0, '#87CEEB');
            skyGradient.addColorStop(1, '#98FB98');
            ctx.fillStyle = skyGradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height * 0.7);
            
            // Draw ground
            ctx.fillStyle = '#8B4513';
            ctx.fillRect(0, canvas.height * 0.7, canvas.width, canvas.height * 0.3);
            
            // Draw grid pattern for ground
            ctx.strokeStyle = 'rgba(139, 69, 19, 0.3)';
            ctx.lineWidth = 1;
            for (let i = 0; i < canvas.width; i += 40) {
                ctx.beginPath();
                ctx.moveTo(i, canvas.height * 0.7);
                ctx.lineTo(i, canvas.height);
                ctx.stroke();
            }
            
            // Draw entities as colored rectangles
            if (botStatus.entities && botStatus.entities.length > 0) {
                botStatus.entities.forEach(entity => {
                    const x = (entity.relativeX + 1) * canvas.width / 2;
                    const y = canvas.height - (entity.relativeY + 1) * canvas.height / 2;
                    
                    if (x >= 0 && x <= canvas.width && y >= 0 && y <= canvas.height) {
                        // Draw entity
                        ctx.fillStyle = entity.type === 'player' ? '#FF6B6B' : '#4ECDC4';
                        ctx.fillRect(x - 10, y - 20, 20, 20);
                        
                        // Draw entity name
                        ctx.fillStyle = 'white';
                        ctx.font = '12px Arial';
                        ctx.fillText(entity.name || entity.type, x - 15, y - 25);
                    }
                });
            }
            
            // Draw blocks in view
            if (botStatus.blocks && botStatus.blocks.length > 0) {
                botStatus.blocks.forEach(block => {
                    const x = (block.relativeX + 1) * canvas.width / 2;
                    const y = canvas.height - (block.relativeY + 1) * canvas.height / 2;
                    
                    if (x >= 0 && x <= canvas.width && y >= 0 && y <= canvas.height) {
                        ctx.fillStyle = getBlockColor(block.type);
                        ctx.fillRect(x - 5, y - 5, 10, 10);
                    }
                });
            }
            
            // Draw movement indicator
            if (botStatus.moving) {
                ctx.fillStyle = 'rgba(255, 255, 0, 0.6)';
                ctx.font = 'bold 16px Arial';
                ctx.fillText('MOVING', canvas.width - 80, 30);
            }
            
            // Update vision info
            const direction = getDirection(botStatus.lookDirection.yaw);
            document.getElementById('lookDirection').textContent = `Looking: ${direction} (${botStatus.lookDirection.yaw.toFixed(1)}¬∞)`;
            document.getElementById('nearestEntity').textContent = `Nearest: ${botStatus.nearestEntity || 'None'}`;
        }
        
        function getBlockColor(blockType) {
            const colors = {
                'stone': '#808080',
                'dirt': '#8B4513',
                'grass': '#90EE90',
                'wood': '#DEB887',
                'leaves': '#228B22',
                'water': '#4169E1',
                'sand': '#F4A460',
                'default': '#A0A0A0'
            };
            return colors[blockType] || colors.default;
        }
        
        function getDirection(yaw) {
            const directions = ['North', 'Northeast', 'East', 'Southeast', 'South', 'Southwest', 'West', 'Northwest'];
            const index = Math.round(((yaw % 360) + 360) % 360 / 45) % 8;
            return directions[index];
        }

        function updateStatus() {
            fetch('/api/status')
                .then(response => response.json())
                .then(data => {
                    botStatus = { ...botStatus, ...data };
                    updateUI();
                    drawBotVision();
                })
                .catch(error => {
                    console.error('Error fetching status:', error);
                });
        }

        function updateUI() {
            // Connection status
            document.getElementById('connectionStatus').textContent = botStatus.online ? 'Online' : 'Offline';
            document.getElementById('connectionStatus').className = botStatus.online ? 'status-value online' : 'status-value offline';
            
            // Bot stats
            document.getElementById('botHealth').textContent = `${botStatus.health}/20`;
            document.getElementById('botHunger').textContent = `${botStatus.hunger}/20`;
            document.getElementById('healthBar').style.width = `${(botStatus.health / 20) * 100}%`;
            document.getElementById('hungerBar').style.width = `${(botStatus.hunger / 20) * 100}%`;
            document.getElementById('deathCount').textContent = botStatus.deaths;
            
            // Position
            document.getElementById('posX').textContent = botStatus.position.x.toFixed(1);
            document.getElementById('posY').textContent = botStatus.position.y.toFixed(1);
            document.getElementById('posZ').textContent = botStatus.position.z.toFixed(1);
            document.getElementById('isMoving').textContent = botStatus.moving ? 'Yes' : 'No';
            
            // Counters
            document.getElementById('popularityCount').textContent = botStatus.popularity;
            document.getElementById('pvpCount').textContent = botStatus.pvp;
            document.getElementById('simpCount').textContent = botStatus.simp;
            
            // Server info
            document.getElementById('serverAddress').textContent = botStatus.server || '-';
            document.getElementById('botUsername').textContent = botStatus.username || '-';
            document.getElementById('gameVersion').textContent = botStatus.version || '-';
            
            // Uptime
            if (botStatus.startTime && botStatus.online) {
                const uptime = Math.floor((Date.now() - botStatus.startTime) / 1000);
                const hours = Math.floor(uptime / 3600);
                const minutes = Math.floor((uptime % 3600) / 60);
                const seconds = uptime % 60;
                document.getElementById('uptime').textContent = 
                    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            } else {
                document.getElementById('uptime').textContent = '00:00:00';
            }
        }

        function updateLogs() {
            fetch('/api/logs')
                .then(response => response.json())
                .then(data => {
                    const logsDiv = document.getElementById('consoleLogs');
                    logsDiv.textContent = data.logs.join('\n');
                    logsDiv.scrollTop = logsDiv.scrollHeight;
                })
                .catch(error => {
                    console.error('Error fetching logs:', error);
                });
        }

        function startBot() {
            fetch('/api/start', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    console.log(data.message);
                })
                .catch(error => {
                    console.error('Error starting bot:', error);
                });
        }

        function stopBot() {
            fetch('/api/stop', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    console.log(data.message);
                })
                .catch(error => {
                    console.error('Error stopping bot:', error);
                });
        }

        function rejoinBot() {
            fetch('/api/rejoin', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    console.log(data.message);
                })
                .catch(error => {
                    console.error('Error rejoining bot:', error);
                });
        }

        // Update status and logs every 2 seconds
        setInterval(() => {
            updateStatus();
            updateLogs();
        }, 2000);

        // Initial load
        updateStatus();
        updateLogs();
    </script>
</body>
</html>
